<!DOCTYPE html>
<html lang="en">
<head>

<title>JavaScript - read JSON from URL</title>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
</head>

<body>
    <div class="mypanel"></div>

    <script>
    BASEURL = 'https://bpv37vsdgg.execute-api.eu-central-1.amazonaws.com/prod'

    function submitComment(id){
      $.ajax({
          url: '"'+BASEURL+'/cards/comments"',
          type: 'post',
          data: {
            "id":id,
            "user":"Tez",
            "comment":document.getElementById("comment-"+id).value
          },
          headers: {
              "Content-Type": 'application/json',
          },
          dataType: 'json',
          success: function (data) {
              console.info(data);
          }
      });

      document.getElementById("comment-"+id).value=''
    }

    function showCard(card){
      html = "";
      html += "<div>"
        html += '<img src="'+card.image_uris.large+'" alt="'+card.name+'">'
        html += '<div>'
          html += 'Buy?'
          html += '<button onclick="">Yes</button>'
          html += '<button onclick="">No</button>'
          html += '<button onclick="">Maybe</button>'
        html += '</div>'
        html += '<div>'
          html += 'Comments:'
          html += '<div id="comments-'+card.id+'">'
          html += '</div>'
          html += '<input type="text" id="comment-'+card.id+'" name="fname"><br>'
          html += '<button onclick="submitComment(\''+card.id+'\')">Submit</button>'
        html += '</div>'
        html += '<div>'
          html += 'Average Price in â‚¬:' + card.prices.eur
        html += '</div>'
      html += "</div>"
      return html;
    }

    $.getJSON('https://api.scryfall.com/cards/search?q=set:DMU color:r', function(data) {
        var text = "";
        data.data.forEach((item, i) => {
          text += showCard(item);
        });
        $(".mypanel").html(text);
    });
    </script>

</body>
</html>
